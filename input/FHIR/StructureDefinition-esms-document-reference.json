{
  "resourceType": "StructureDefinition",
  "id": "esms-document-reference",
  "url": "https://interop.esante.gouv.fr/ig/fhir/sdo/StructureDefinition/esms-document-reference",
  "version": "1.2",
  "name": "ESMSDocumentReference",
  "status": "active",
  "date": "2024-01-19T09:51:35+02:00",
  "publisher": "ANS",
  "description": "Profil pour définir le dossier ESMS",
  "fhirVersion": "4.0.1",
  "kind": "resource",
  "abstract": false,
  "type": "DocumentReference",
  "baseDefinition": "https://interop.esante.gouv.fr/ig/fhir/sdo/StructureDefinition/sdo-document-reference",
  "derivation": "constraint",
  "differential": {
    "element": [
      {
        "id": "DocumentReference",
        "path": "DocumentReference",
        "constraint": [
          {
            "key": "regle-NomPieceJointe", 
            "severity": "warning",
            "human": "Le nom de la pièce jointe doit être  : \"Document Individu et décision\" ou \"Document évaluation\"",
            "expression": "content.attachment.title='Document Individu et décision' or content.attachment.title='Document évaluation'"
          },
          {
              "key": "regle-Contenu", 
              "severity": "error",
              "human": "Le transport des données est obligatoire, le champ data doit être rempli",
              "expression": "content.attachment.data.exists()"
            }
          
        ]
      },
      {
        "id": "DocumentReference.identifier",
        "path": "DocumentReference.identifier",
        "min": 2
      },
      {
        "id": "DocumentReference.type",
        "path": "DocumentReference.type",
        "min": 1
      },
      {
        "id": "titreDocu",
        "path": "DocumentReference.content.attachment.title",
        "min": 1,
        "short": "Le titre doit être soit 'Document CDA portant les données de l'individu et la décisision' ou 'Document CDA portant l'évaluation'"
      }
    ]
  }
}
