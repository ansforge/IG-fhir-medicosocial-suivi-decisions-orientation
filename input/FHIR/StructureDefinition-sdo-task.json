{
	"resourceType": "StructureDefinition",
	"id": "sdo-task",
	"text": {
	  "status": "extensions"
	  
	},
	"url": "https://interop.esante.gouv.fr/ig/fhir/sdo/StructureDefinition/sdo-task",
	"version": "4.0.2-ballot",
	"name": "SDOTask",
	"status": "active",
	"date": "2023-07-06T09:51:35+02:00",
	"publisher": "ANS",
	"contact": [
	  {
		"name": "ANS",
		"telecom": [
		  {
			"system": "url",
			"value": "https://esante.gouv.fr"
		  }
		]
	  }
	],
	"description": "Profil utilisé pour véhiculer les informations sur la position des ESMS et des unités opérationnelles vis-à-vis de la prestation",
	"fhirVersion": "4.0.1",
	"mapping": [
	  {
		"identity": "workflow",
		"uri": "http://hl7.org/fhir/workflow",
		"name": "Workflow Pattern"
	  },
	  {
		"identity": "rim",
		"uri": "http://hl7.org/v3",
		"name": "RIM Mapping"
	  },
	  {
		"identity": "w5",
		"uri": "http://hl7.org/fhir/fivews",
		"name": "FiveWs Pattern Mapping"
	  },
	  {
		"identity": "v2",
		"uri": "http://hl7.org/v2",
		"name": "HL7 v2 Mapping"
	  }
	],
	"kind": "resource",
	"abstract": false,
	"type": "Task",
	"baseDefinition": "http://hl7.org/fhir/StructureDefinition/Task",
	"derivation": "constraint",
	"differential": {
	  "element": [
		{
		  "id": "Task",
		  "path": "Task",
		  "constraint": [
			{
			  "key": "regle-StatutUnite",
			  "severity": "error",
			  "human": "Si statut unite alors pein de trucs",
			  "expression": "input.type.where(text='idUnite').exists() and input.type.where(text='nomUnite').exists() and input.type.where(text='categorieOrganisation').exists() and input.type.where(text='modePriseCharge').exists() and input.type.where(text='dateStatutUnite').exists() or input.type.where(text='statutUnite').exists().not()"
			},
			{
				"key": "regle-PresenceInput",
				"severity": "error",
				"human": "Les éléments suivants doivent être présent",
				"expression": "input.type.where(text='idNat_Decision').exists() and input.type.where(text='idDecision').exists() and input.type.where(text='nomESMS').exists() and input.type.where(text='idNat_Struct').exists()"
			  }
			  ,
			  {
				  "key": "regle-ModePriseEnCharge",
				  "severity": "error",
				  "human": "Les codes possibles pour le mode de prise en charge sont : Code 46 « Hébergement (accueil jour et nuit) » = Internat (1),Code 47 « Accueil de jour » = externat (2), semi-internat (3) ou accueil de jour (6),Code 48 Accueil de nuit » = Accueil de nuit (4)",
				  "expression": "input.where(type.text='modePriseCharge').value.coding.code='48' or input.where(type.text='modePriseCharge').value.coding.code='47'  or input.where(type.text='modePriseCharge').value.coding.code='46' "
			  }
				]
		},
		{
		  "id": "Task.meta",
		  "path": "Task.meta"
		},
		{
		  "id": "Task.meta.lastUpdated",
		  "path": "Task.meta.lastUpdated",
		  "min": 1
		},
		{
		  "id": "Task.status",
		  "path": "Task.status",
		  "fixedCode": "completed"
		},
		{
		  "id": "Task.intent",
		  "path": "Task.intent",
		  "fixedCode": "plan"
		},
		{
		  "id": "Task.input",
		  "path": "Task.input",
		  "slicing": {
			"discriminator": [
			  {
				"type": "value",
				"path": "type.text"
			  }
			],
			"rules": "open"
		  }
		  
		},
		{
		  "id": "Task.input:idNat_Struct",
		  "path": "Task.input",
		  "sliceName": "idNat_Struct",
		  "max": "1"
		},
		{
		  "id": "Task.input:idNat_Struct.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "idNat_Struct"
		},
		{
		  "id": "Task.input:idNat_Struct.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "string"
			}
		  ]
		},
		{
		  "id": "Task.input:nomESMS",
		  "path": "Task.input",
		  "sliceName": "nomESMS",
		  "max": "1"
		},
		{
		  "id": "Task.input:nomESMS.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "nomESMS"
		},
		{
		  "id": "Task.input:nomESMS.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "string"
			}
		  ]
		},
		{
		  "id": "Task.input:statutESMS",
		  "path": "Task.input",
		  "sliceName": "statutESMS",
		  "max": "1"
		},
		{
		  "id": "Task.input:statutESMS.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "statutESMS"
		},
		{
		  "id": "Task.input:statutESMS.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "CodeableConcept"
			}
		  ],
		  "binding": {
			"strength": "required",
			"valueSet": "https://mos.esante.gouv.fr/NOS/JDV_J252-StatutPersonnePriseChargeESMS/"
		  }
		},
		{
		  "id": "Task.input:motifESMS",
		  "path": "Task.input",
		  "sliceName": "motifESMS",
		  "max": "1"
		},
		{
		  "id": "Task.input:motifESMS.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "motifESMS"
		},
		{
		  "id": "Task.input:motifESMS.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "CodeableConcept"
			}
		  ],
		  "binding": {
			"strength": "required",
			"valueSet": "https://mos.esante.gouv.fr/NOS/JDV_J251-MotifStatutPersonnePriseChargeESMS/"
		  }
		},
		{
		  "id": "Task.input:dateStatutESMS",
		  "path": "Task.input",
		  "sliceName": "dateStatutESMS",
		  "max": "1"
		},
		{
		  "id": "Task.input:dateStatutESMS.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "dateStatutESMS"
		},
		{
		  "id": "Task.input:dateStatutESMS.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "date"
			}
		  ]
		},
		{
		  "id": "Task.input:idUnite",
		  "path": "Task.input",
		  "sliceName": "idUnite",
		  "max": "1"
		},
		{
		  "id": "Task.input:idUnite.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "idUnite"
		},
		{
		  "id": "Task.input:idUnite.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "Identifier"
			}
		  ]
		},
		{
		  "id": "Task.input:nomUnite",
		  "path": "Task.input",
		  "sliceName": "nomUnite",
		  "max": "1"
		},
		{
		  "id": "Task.input:nomUnite.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "nomUnite"
		},
		{
		  "id": "Task.input:nomUnite.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "string"
			}
		  ]
		},
		{
		  "id": "Task.input:categorieOrganisation",
		  "path": "Task.input",
		  "sliceName": "categorieOrganisation",
		  "max": "1"
		},
		{
		  "id": "Task.input:categorieOrganisation.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "categorieOrganisation"
		},
		{
		  "id": "Task.input:categorieOrganisation.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "CodeableConcept"
			}
		  ],
		  "binding": {
			"strength": "required",
			"valueSet": "https://mos.esante.gouv.fr/NOS/TRE_R244-CategorieOrganisation/"
		  }
		},
		{
		  "id": "Task.input:temporaliteAcceuil",
		  "path": "Task.input",
		  "sliceName": "temporaliteAcceuil",
		  "max": "1"
		},
		{
		  "id": "Task.input:temporaliteAcceuil.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "temporaliteAccueil"
		},
		{
		  "id": "Task.input:temporaliteAcceuil.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "CodeableConcept"
			}
		  ],
		  "binding": {
			"strength": "required",
			"valueSet": "https://mos.esante.gouv.fr/NOS/TRE_R240-TemporaliteAccueil/"
		  }
		},
		{
		  "id": "Task.input:accueilSequentiel",
		  "path": "Task.input",
		  "sliceName": "accueilSequentiel",
		  "max": "1"
		},
		{
		  "id": "Task.input:accueilSequentiel.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "accueilSequentiel"
		},
		{
		  "id": "Task.input:accueilSequentiel.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "boolean"
			}
		  ]
		},
		{
		  "id": "Task.input:modePriseCharge",
		  "path": "Task.input",
		  "sliceName": "modePriseCharge",
		  "max": "1"
		},
		{
		  "id": "Task.input:modePriseCharge.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "modePriseCharge"
		},
		{
		  "id": "Task.input:modePriseCharge.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "CodeableConcept"
			}
		  ],
		  "binding": {
			"strength": "required",
			"valueSet": "https://mos.esante.gouv.fr/NOS/JDV_XXX-ModePriseEnCharge/"
		  }
		},
		{
		  "id": "Task.input:statutUnite",
		  "path": "Task.input",
		  "sliceName": "statutUnite",
		  "max": "1"
		},
		{
		  "id": "Task.input:statutUnite.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "statutUnite"
		},
		{
		  "id": "Task.input:statutUnite.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "CodeableConcept"
			}
		  ],
		  "binding": {
			"strength": "required",
			"valueSet": "https://mos.esante.gouv.fr/NOS/JDV_J253-StatutPersonnePriseChargeUnite/"
		  }
		},
		{
		  "id": "Task.input:dateStatutUnite",
		  "path": "Task.input",
		  "sliceName": "dateStatutUnite",
		  "max": "1"
		},
		{
		  "id": "Task.input:dateStatutUnite.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "dateStatutUnite"
		},
		{
		  "id": "Task.input:dateStatutUnite.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "date"
			}
		  ]
		},
		{
		  "id": "Task.input:motifUnite",
		  "path": "Task.input",
		  "sliceName": "motifUnite",
		  "max": "1"
		},
		{
		  "id": "Task.input:motifUnite.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "motifUnite"
		},
		{
		  "id": "Task.input:motifUnite.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "CodeableConcept"
			}
		  ],
		  "binding": {
			"strength": "required",
			"valueSet": "https://mos.esante.gouv.fr/NOS/JDV_J250-MotifStatutPersonnePriseChargeUnite/"
		  }
		},
		{
		  "id": "Task.input:typeDroitPrestation",
		  "path": "Task.input",
		  "sliceName": "typeDroitPrestation",
		  "max": "1"
		},
		{
		  "id": "Task.input:typeDroitPrestation.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "typeDroitPrestation"
		},
		{
		  "id": "Task.input:typeDroitPrestation.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "CodeableConcept"
			}
		  ],
		  "binding": {
			"strength": "required",
			"valueSet": "https://mos.esante.gouv.fr/NOS/JDV_JXX-typeDroitPrestation/"
		  }
		},
		{
		  "id": "Task.input:idDecision",
		  "path": "Task.input",
		  "sliceName": "idDecision",
		  "max": "1"
		},
		{
		  "id": "Task.input:idDecision.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "idDecision"
		},
		{
		  "id": "Task.input:idDecision.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "string"
			}
		  ]
		},
		{
		  "id": "Task.input:idNat_Decision",
		  "path": "Task.input",
		  "sliceName": "idNat_Decision",
		  "max": "1"
		},
		{
		  "id": "Task.input:idNat_Decision.type.text",
		  "path": "Task.input.type.text",
		  "fixedString": "idNat_Decision"
		},
		{
		  "id": "Task.input:idNat_Decision.value[x]",
		  "path": "Task.input.value[x]",
		  "type": [
			{
			  "code": "string"
			}
		  ]
		}
	  ]
	}
  }